<%= content_for :heading, "Editing" %>
<%= content_for :subheading, @model.name %>
<%= content_for :nav_items do %>
    <%= render "ui/navigation_menu/item" do %>
      <%= render "ui/navigation_menu/link", href: darwin.root_path, trigger_style: true do %>
        Back
      <% end %>
    <% end %>
<% end %>


<div class="space-y-8">
  <%= render "ui/card" do %>

    <%= render "ui/card/content", classes: "space-y-5" do %>
      <%= form_with(model: @model, url: darwin.model_path(@model)) do |form| %>
        <% name_field_id = form.field_id(:name) %>
        <% name_field_name = form.field_name(:name) %>
        <%= render "ui/field" do %>
          <%= render "ui/field/label", for_id: name_field_id do %>Name<% end %>
          <%= render "ui/field/content" do %>
            <%= render "ui/input", id: name_field_id, name: name_field_name, value: form.object.name %>
          <% end %>
          <% if form.object.errors[:name].any? %>
            <%= render "ui/field/error", content: form.object.errors.full_messages_for(:name).to_sentence %>
          <% end %>
        <% end %>

        <div class="flex justify-end">
          <%= render "ui/button", classes: "mt-2", type: "submit" do %>Update Name<% end %>
        </div>
      <% end %>
    <% end %>
  <% end %>

      <div class="grid gap-2">
        <p class="text-xs font-semibold uppercase tracking-wide text-muted-foreground">Columns</p>
        <div class="flex flex-wrap gap-2 text-sm text-muted-foreground">
          <% @model.runtime_constant.columns.each do |column| %>
            <%= render "ui/badge" do %><%= column.name.humanize %><% end %>
          <% end %>
        </div>
      </div>

  <%= render "ui/card", classes: "space-y-4" do %>
      <%= render "ui/card/header", classes: "flex items-center justify-between" do %>
        <%= render "ui/card/title", content: "Blocks" %>
      <% end %>

    <%= render "ui/card/content", classes: "space-y-4" do %>
      <div id="blocks" class="space-y-4">
        <%= render @model.blocks %>
      </div>
    <% end %>
  <% end %>


          <div class="flex flex-wrap gap-2">
          <% available_method_names(@model).each do |method_name| %>
            <%= form_with url: darwin.model_blocks_path(@model), method: :post, html: { class: "inline-block" } do %>
              <%= hidden_field_tag "darwin_block[method_name]", method_name %>
              <%= render "ui/button", variant: "outline", type: "submit" do %>
                Add <%= method_name.humanize %>
              <% end %>
            <% end %>
          <% end %>
        </div>
</div>
