<div class="nested-fields darwin-card" data-controller="block-form" data-new-record="<%= f.object.new_record? %>">
  <div class="darwin-card__body space-y-4">
    <div class="darwin-form__group">
      <%= f.label :method_name, "Block type" %>
      <%= f.select :method_name,
                   %w[attribute validates belongs_to has_many has_one accepts_nested_attributes_for],
                   { include_blank: 'Select a block type' },
                   { data: { action: "change->block-form#update" } } %>
    </div>

    <div data-block-form-target="fields" class="space-y-3">
      <% if f.object.method_name.present? %>
        <%= render partial: "darwin/models/block_forms/#{f.object.method_name}", locals: { f: f } %>
      <% end %>
    </div>

    <div class="darwin-actions justify-between">
      <span class="darwin-badge">Block</span>
      <%= link_to "Remove", "#", data: { action: "nested-form#remove" }, class: "darwin-btn darwin-btn--danger" %>
    </div>
  </div>
</div>
