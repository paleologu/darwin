<div class="nested-fields" data-controller="block-form" data-new-record="<%= f.object.new_record? %>">
  <div class="field">
    <%= f.label :method_name %>
    <%= f.select :method_name, %w[attribute validates belongs_to has_many has_one accepts_nested_attributes_for], { include_blank: 'Select a block type' }, { data: { action: "change->block-form#update" } } %>
  </div>

  <div data-block-form-target="fields">
    <% if f.object.method_name.present? %>
      <%= render partial: "darwin/models/block_forms/#{f.object.method_name}", locals: { f: f } %>
    <% end %>
  </div>

  <%= f.hidden_field :_destroy %>
  <%= link_to "Remove", "#", data: { action: "nested-form#remove" } %>
</div>